[**SMP 2차 관련 사항들 모음**](obsidian://open?vault=RecordStorage&file=SMP%202%EC%B0%A8%20%EC%84%A4%EA%B3%84%20%EA%B4%80%EB%A0%A8%20%EC%82%AC%ED%95%AD%EB%93%A4)
[**2. 29 2차 데모 개발 관련 사항 정리](obsidian://open?vault=ALLTHING&file=2%EC%B0%A8%20(2.%2029%20%EA%B8%B0%ED%95%9C)%20%EB%8D%B0%EB%AA%A8%20%EC%84%A0%20%EA%B0%9C%EB%B0%9C%20%EA%B4%80%EB%A0%A8%20%EC%82%AC%ED%95%AD%EB%93%A4)
[2차 데모 이후 필요 진행 사항 정리](obsidian://open?vault=ALLTHING&file=%E3%84%B1.%20%ED%95%B4%EC%95%BC%ED%95%A0%20%EC%9D%BC%2F2%EC%B0%A8%20(2.%2029%20%EB%8D%B0%EB%AA%A8%20%EC%9D%B4%ED%9B%84)%20%ED%95%84%EC%9A%94%20%EC%82%AC%ED%95%AD)


## 11. 20
- 이미지(그림) 표현 방식(smp, davis) -> davis lite 방식과 동일하게 ( api 요청 후 응답의 image 경로를 html img tag에 설정 ) -> SMP 적용 필요
- 



##### 확인. map/forEach 등 배열 함수 내부에서 push 사용하지 않기 -> 정확하게 다시 확인 후 수정 필요

##### Tip. 반복되는 코드 내에서 비동기 작업을 수행할 때는 순서가 보장되지 않기 때문에 Promise.all() / Promise Chain 과 같은 처리를 해야 결과를 기다리고, 순서를 보장할 수 있다.

##### Vue defineAsyncComponent 알아보기


#### Davis-Lite
- [ ] Metering
	- [x] 미터링 조회 조건 선택 메타데이터 마지막 조회 대상 api 수정 필요
	- [x] 미터링 조회 버튼 처리 필요
	- [ ] 
	- [ ] Chart 형태 별(Line, Bar 등) 표현
	- [x] 조회 대상 input 수정 필요
	- [x] report list created date로 column명 수정 필요
	- [x] KPI Metering 조회, Metering 조회 flag 추가 -> 대시보드 위젯 metering 조회 api 사용중
	- [x] report 주기 기본 값 문제 조정 필요 0 -> 1 or 선택 안되면 POST 불가? -> 해당 되지 않는 주기 값들은 표현 되지 않도록 조정 -> 0 값 없애야 함
	- [x] 스피넬 화면과 동일하게, 차트와 해당 레포트 출력되는 테이블 정보(레포트 상세보기 기능이라고 생각해도 될 듯)
	- [x] SaaS, User, Type 별 사용량, 자원 사용량, 기간별 통계 데이터 표현
		- 표현 방식이나 filtering 방식은 정해야 함

- [ ] Report
	- [ ] 레포트 등록 -> 등록일 기준 다음날 000000시분초 ~ 다다음날 000000 시분초 -> 시분초 사용자 등록 X, 시간 주기는 그대로(스케쥴 등록 시작 시간은 과거 선택 불가)
	- [x] 레포트 미리보기 다운로드 api 방식으로 수정 필요
	- [ ] 리포트 등록 -> 날짜에 따라 주기 선택 영역 item align 움직이는 현상 -> 주기 목록 영역 고정
	- [ ] 주기 선택 항목 없을때는 none 항상 default 선택되도록 수정 필요
	- [x] 리포트 목록 -> period type 추가
	- [ ] 등록 -> 캘린더 그림 한번 더 클릭 -> 날짜 사라지고 주기는 그대로 남아있음 문제
	- [x] 레포트 리스트는 최신 내림차순으로 sorting 중, 그대로 표현만 하면 될 듯
	- [x] 레포트 리스트 생성 시간은 end time, 시간은 end time만 표현
	- [x] 스케쥴 시간 하나로 합치기
	- [x] 미리보기 여러 페이지 인쇄 안되는 문제 해결 필요 -> 새로운 페이지 띄워서 임시 해결 -> 컴포넌트 + 다운로드 API 방식으로 추후 수정 필요
	- [ ] 
	- [x] 기존 레포트 다운로드를 미리보기(HTML)로 하고, 해당 미리보기에서 pdf/excel 다운로드 할 수 있도록 -> 기존 등록 화면에서 export type 삭제 -> 미리보기는 Png, 다운로드는 PDF 형식으로 변경
	- [x] Cron Job 설정 방식 수정 필요 - single 선택, start부터 none/시간/일/주/월 마다 설정
	- [x] schedule start/end time 삭제
	- [x] report start/end time 사이에 repeat 선택에 대한 유효성 검사 없이 등록 가능하며, 일정을 넘어가는 주기에 대해서는 end 시간에 최종 report 목록 생성하고 끝내는 걸로(최종 리포트 표시 필요)
	- [x] 기존 kpi 등록된 항목들을 선택해서 report 등록 -> kpi 분류(type/지표-멀티 선택) 기준으로 kpi 목록 조회 후 선택
	- [x] report 실행 개념은 보류

#### SMP(Garnet)
- [ ] 공통
	- [ ] 다국어 설정 추가

- [ ] 신청 관리
	- [ ] 신청 관리 내부 모든 테이블 검색 기능 추가 필요
	- [ ] 이미 신청한 라이선스가 있을 때, 새로운 라이선스 신청을 온보딩 템플릿에 추가하면 중복 신청이 막아지는게 맞는지?
	- [ ] 라이선스/온보딩 클릭한 항목에 따라 신청 컴포넌트 나누기?
	- [ ] 승인/반려 창에서 승인시 사유 입력 필요 없음 -> 개선 필요
	- [x] 라이선스 선택 -> 등록 시 라이선스 중복 등록 불가 처리
	- [x] 라이선스 신청 목록 스크롤 기능 추가 필요
	- [ ] 라이선스 / 온보딩 등록 구분 -> 초기 탭으로 구분
	- [x] 라이선스 신청 -> 온보딩 템플릿으로 추가 -> 온보딩 목록에 없음
	- [x] 취소 상태의 라이선스 신청 목록에서는 어떤 버튼도 나오지 않아야 한다.
	- [x] 온보딩 신청 대기 목록 펼쳐보기 다 같이 펼쳐지는 문제 수정 필요

- [ ] 소프트웨어 관리
	- [x] 등록된 소프트웨어는 계약 된 소프트웨어 목록을 가져온다.
	- [x] 등록 버튼 삭제
	- [x] 등록 상태의 소프트웨어는 삭제 버튼 없어짐
	- [x] 설치 상태의 소프트웨어만 : 삭제 -> 초기화
	- [ ] yaml 파일 업로드 후에 가용 자원 받아오는 api 추가 필요
	- [ ] 설치 단계에서 라이선스 등록 삭제
		- [ ] 최종 소프트웨어 설치 api에서 파라미터 변경 필요
	- [ ] 문제점 발생
		- [ ] 설치 중인 소프트웨어가 있을 경우,
			- [ ] 해당 소프트웨어 검색 후 polling OK
			- [ ] 검색 초기화(전체 목록 조회) polling OK
			- [ ] 전체 목록 조회 -> 설치중 상태가 아닌 소프트웨어 검색 polling NOK
			- [ ] 설치중 상태가 아닌 소프트웨어 검색 -> 전체 목록 조회 polling NOK

- [ ] 라이선스 키 관리
	- [x] REST API 요청 store 에서 처리로 변경
	- [x] 키 할당/회수 시 chart 바로 반영 추가 필요
	- [x] 최초 화면 소프트웨어 목록 검색 영문 대/소문자 처리 필요

- [ ] 메뉴 권한 관리
	- [ ] 권한 변경 후 다시 한번 더 저장 버튼을 누르면 변경이 됨 -> 수정 필요
	- [x] 메뉴 권한 POST param 트리 구조로 변경 가능한지

- [ ] 온보딩
	- [ ] 온보딩 등록은 어디서부터 가능인지?
	- [ ] **온보딩 추가 -> 설명 optional, 입력한 설명 볼 수 없음, 상세보기 필요(상세보기에서 라이선스 목록 보여주는것으로) - 상무님 요청사항**

- [ ] VOC
	- [ ] 문의 등록은 사용자 포탈 등급 모두
	- [ ] 담당자 등록, 답변 모두 지원 관리 권한만
	- [ ] 담당자를 배정 받지 않은 문의는 지원 관리 권한자가 모든 내역을 볼 수 있게
	- [ ] 일반 사용자도 재문의 버튼 처리 필요



#### 공통 에러 처리
- 에러 처리 방식 수정 필요?
	- 서버와 통신을 성공해서 서버에서 보내는 모든 에러는 200, result: nok
	- 그 외의 모든 문제는 예외 처리를 통해 공통에서 처리한다.
		- 서버와 통신 불가 또는 예상 외의 모든 에러에 대해 - 
- [x] 현재 다국어 설정에 백엔드에서 보내는 에러 코드를 정리
	- [x] 백엔드에서 받는 에러 코드를 다국어로 처리![[에러 처리 방식 다국어 적용.png]]
- [ ] 백엔드에서 정의된 에러 코드(암호화)를 받아서 사용자에게 노출
	- [ ] 암호화가 필요하지 않은 간단한 에러 혹은 세션 만료와 같은 사용자 해결 가능한 에러들은 화면에서 메세지 표시
	- [ ] 에러가 아닌 문제들(제목 중복, 항목 없음 등)은 최대한 에러 메세지를 사용하지 않고 UI에 표현하는 방식으로

#### 온보딩(라이선스 템플릿 관리)
- 라이센스 목록 가져오기 공통 컴포넌트 api 변경 필요
	- v2의 라이센스 목록 가져오기 api 데이터 변경 필요 ( 라이센스 아이디, 스프트웨어 아이디 등)
- 온보딩(템플릿 추가) 수정 사항
	- 라이선스 검색 후 추가
	- 라이선스 목록에는 소프트웨어 이름, 라이선스 이름, 계약 시작, 만료일, 라이선스 설명(추가 여부 미결정) 이 들어가야 함
 
- 신청 관리 수정사항
	- 온보딩(템플릿) 추가 화면에서
		- 추가 버튼 삭제
		- 검색은 템플릿 검색
		- 기간은 템플릿에 대한 하나의 기간만 설정
		- 템플릿을 검색했을 때, 템플릿에 해당하는 모든 라이선스 목록이 나와야 하며, 여기서도 위와 같이 소프트웨어 이름, 라이선스 이름, 계약 시작, 만료, 설명(미정) 이 나와야 한다.
		- 해당 템플릿에 대한 신청 정보의 파라미터는 템플릿 아이디, 기간, 신청 사유가 필요할 듯


#### 소프트웨어 관리 추가 수정(03. 21 회의 내용 바탕)
- S/W 등록은 계약서 내용을 바탕으로 해당 정보를 바로 등록하는 것으로
- S/W 설치
	- 자원 등록 기능은 완전 삭제
	- 1. Cluster Tree 에서 어떤 Cluster에 설치할 것인지를 선택할 수 있어야 한다.
	- 2. yaml을 등록해서 필요 자원과 해당 자원을 Spinel에서 수용할 수 있는지를 파악하고, 해당 정보를 나타낼 수 있어야 한다.
	- 3. Repository 정보는 SMP에서 관리하는 하나의 Repository 정보에서 가져오며, 한 개 혹은 여러 개가 될 수 있다.( 서버에서 받아오는 정보를 표현만 하면 됨 )
- S/W 상세 정보에서 계약 번호를 표시해야 한다.

### 업무

##### - 공통
- [ ] 검색기능, 에러 처리 모듈화
- [x] 퍼블리싱 용 새로운 도메인 하나 생성하기
	- default.conf 수정 필요 X
	- docker-compose service name 수정, 포트 넘버 수정 필요
	- gitlab-ci.yml 를 통한 빌드(노드, 도커)로 이미지, 컨테이너 생성 필요
- [ ] 빌드 패키지에 이미지가 정상적으로 추가되지 않는 문제(로컬 정상 이미지(그림파일) -> 패키지 이미지(그림파일) 깨짐 문제 확인 필요 )
- [x] 다국어 설정 적용
	- [x] VOC
	- [x] 계약 관리
	- [x] 라이센스 키 관리
- [x] 검색 경고 메세지 없애기
- [x] api call 할 때마다 매번 나타나는 로딩 화면 매번 나타나지 않도록 처리 필요
- [ ] 테이블 tr 각 목록 width 고정 필요

- 공통 - 정해진 사항
	1. alert 알림 없음
	2. 데이터 없을 경우, quasar table에서 제공하는 기본 no-data로 설정 -> 기능이 적용 안됨 -> ~~버전 변경 필요~~ > 기존 CSS에 no-data 미표시 적용 > 수정 완
	3. 통신 에러의 경우, 하단 notify
	4. 서버 이미지 로딩의 경우, 참조하는 URL 받아서 동적으로 표시



##### - CICD / Build
- [x] 브랜치 변경
	- 현재 main은 제거
	- 현재 bt 브랜치를 세가지 브랜치로 나누어야 한다.
	- bt 최종(freeze, lock 필요), 2차(1.0), 3차(1.1, main)
	- commit, merge 방식은 내가 정함(각자 merge OR 중간 merge branch)


- [x] 현재 메인 빌드, 제품 빌드 브랜치 따로 구성, 메인과 bt 빌드 브랜치는 cicd, 도커 빌드에 필요한 설정 파일에서 각각 차이가 있을 수 있다.
- [x] eslint 관련 빌드 속도 개선 방안 적용(아래 링크 참고)
- [x] 현재 방식은 한번에 main에 커밋하기 때문에 커밋되기 전까지는 각 작업자 로컬에 변경사항이 적용되지 않은 채 원격에 커밋되기 때문에 한번에 합칠 때 많은 충돌이 일어남
	- [x] main 하위 브랜치에 각자 커밋 push하고 작업하기 전에 해당 하위 브랜치를 pull 해서 사용하는 방식으로 변경 필요할 듯
	 -> BT main 브랜치를 bt-main으로 변경하면서 방식도 커밋 방식도 변경
- [x] CICD 3단계 1단계로 통합( 현재 docker + nodejs 통합한 이미지 적용, 캐시 기능 적용 -> 3단계 통합 ) - 완료
- [x] 메인 빌드 / BT 빌드 브랜치, CICD, 도메인 분리


> [프론트엔드 빌드 속도 개선 관련 ](https://velog.io/@lingodingo/%EB%B9%8C%EB%93%9C-%EC%86%8D%EB%8F%84%EB%A5%BC-%EC%98%AC%EB%A0%A4%EB%B3%B4%EC%9E%90feat.-esbuild)



##### - 소프트웨어 관리
###### 트리 표현
- 노드 클릭했을 때 각각 api call
- install progress는 각각 선택된 노드 아이디의 소프트웨어 목록 polling
- 위 두 항목은 하나의 api를 사용한다.
- 소프트웨어 상태, 워크로드 상태, progress 모두 위 한 가지 api를 통해 얻는다
- 트리 구조는 상위 노드를 선택했을 때 하위 노드의 총합을 표현한다.
- polling 할 때, 소프트웨어 목록과 tree 항목도 함께 해야 한다.
- [x] 소프트웨어 상세 정보 - 새로 고침 시 상태 정보 잃음 -> 라우팅 방식 변경으로 해결
- [ ] 현재 미완성, 필요한 사항
	- 등록 후 새로고침 작동 안함, 이유 모름
		-> 계약 목록에서 등록된 소프트웨어 목록 가져올 것이므로 필요 없음
	- 삭제 api 추가 안됨
	- 설치
		-> Yaml 파일 등록 후 트리 구조 적용 안됨
		-> 선택된 트리에 해당하는 자원 정보 표시 안됨
		-> 이미지 레포 get api 없음
		-> 라이센스 타입 get api 없음
		-> 라이센스 타입에 대한 설명 post api 필요
	- 설치 각 단계에서 유효성 검사 방식 파악 필요
	- 에러 처리 공통화 모듈 생성 필요
	- 소프트웨어 목록 테이블 t-head 확인 필요



##### - 라이센스 키 관리
- [x] 라이센스 키 관리 차트 적용 방식 변경필요 - 사용량 순으로 6개 부서까지만 적용, 키를 사용하는 부서만 표시
- [x] 라이센스 키 관리 - 소프트웨어 목록 새로고침 방식 GET api 새로 call 하는 방식으로 변경

- 정해진 사항
	1. 라이센스 키 관리 초기 화면 삭제 - 키 관리 화면에 간단한 정보 표시
	2. 사용자 할당 화면의 날짜 - 사용자가 신청한 라이센스 사용 기간 표시
	3. 라이센스 키 할당은 신청자만 가능
	4. 라이센스 키 할당에서 신청자 - 직급 정보 삭제
	5. 라이센스 키 관리 흐름
		- 사용자 라이센스 사용 신청 -> 관리자 승인(계약) -> 신청 수량에 맞는 라이센스 키 발급 -> 발급된 키를 사용자에게 할당



##### - 계약 관리 
- [x] no-data 표시 오류 처리
- [x] pagination -> virtual scroll

- 정해진 사항
	1. 더 보기 없앰, 차트 없앰, 각 항목 별로 파일 첨부 기능 추가
	2. 초기 리스트 화면에서는 소프트웨어가 아닌 계약 내역 목록을 표시
	3. 상세 보기 화면에서 선택한 계약에 해당하는 소프트웨어와 그 소프트웨어의 라이센스 목록을 보여준다.
	4. 파일 첨부 - 현재 파일이 있다면 삭제 후 재 첨부만 가능



##### - VOC
- [ ] 담당자 검색 오류처리 -> 현재 검색 기능 quasar :filter로 되어있음 -> 변경 필?요?
- [x] SA 등급 VOC 등록 불가 처리
- [x] VOC 확장 기능 없이 단순 테이블로 변경
- [x] pagination -> virtual scroll
- [x] 본인에게 답변 등록 불가 처리

- 정해진 사항
	1. 신규 등록  - 처리중(담당자 배정 / 답변 보류) - 답변 완료 - VOC 종료 / 재문의
	2. UI에서의 재문의 표시는 문의 이력 유무로 판단해 직접 표시한다.
	3. 재문의 자체는 처리중 상태로 생각한다.
	4. VOC 상태값
		- 1: 소프트웨어 관련 문의, 2: 라이센스 관련 문의, 3. 기타 문의
	5. 사용자에 따라 VOC 목록 표시 -> 세션을 기준으로, 서버에서 로그인 사용자가 볼 수 있는 내용들만 전송 받음
		- 아래 항목은 협의 되지 않은 사항임.
			- 일반 사용자 : 본인이 작성한 VOC만 조회
			- 담당자 : 본인에게 배정된 VOC 목록에 대해서만 조회
			- SA 모든 VOC 항목에 대해 조회
			- 담당자에게 VOC를 배정해주는 주체가 누구인지? ( SA? or 담당자 중에서 특정 권한 담당자만? )
	6. SA는 VOC 등록 불가, manager 등급은 VOC 등록 가능, 현재는 본인이 등록한 VOC와 속한 그룹 내의 사용자가 등록한 VOC를 한 테이블 내에서 보여주고, 본인이 등록한 VOC는 조회만 가능(답변 등록 X - 모든 권한 동일하게 적용)




##### - 리팩토링
- [ ] 라이센스 키 관리 차트 컴포넌트로 빼기
- [ ] 라이센스 키 관리 스토어 분리
- [x] 계약 관리 활성/만료 분리
- [ ] 각 api 에러 처리 통일( voc 답변 등록 에러 처리 참고 )
- [ ] 백엔드에서 보내는 에러 메세지를 바로 쓰는 것은 X, 추후 에러 코드로 변경, 에러 메세지 모듈화


#### 기존 프로젝트 ->SMP 수정 사항
- Patch Api 추가
- HttpHelperV1 삭제
- HttpHelperV2 로그인 모듈 분리
- HttpResult.ts 로 에러코드 관리
- isDisableShowError 에러 베세지 표시 방법 확인 필요
- 각 기능 페이지 별로 에러코드 처리
	-> REST에서 오류 처리를 메세지로 줄 것인지, 코드로 주고 각 에러에 대한 내용을 정의해 줄 것인지를 정해야 HttpResult Enums을 어떻게 사용할 것인지 정할 수 있음
- result = NOK -> {ErrorCode ErrorMsg}
		= OK -> Data?
			=> 통신 연결에 관한 정상 여부 파악은 statusText, 데이터 값 정상 여부 파악은 response.data 값 내부의 result로 파악한다.
			=> result 값이 nok인 경우, 데이터 값이 비정상이며, 해당 오류에 대한 내용은 error 항목 내부에서 볼 수 있다.
- 그 외 HTTP Status 에러 처리 들어가야 함
